machine:
  services:
    - docker
  environment:
    COMPOSE_PROJECT_NAME: 'addonsserver'
    DOCKER_NAME: 'addonsserver_web_1'

dependencies:
  override:
    - pip install -r requirements/uitest.txt

test:
  pre:
    - docker-compose pull
    - docker-compose up -d
  override:
    - cd src/olympia/amo/tests/ui
    - py.test -r a --base-url http://$(docker inspect --format '{{ .NetworkSettings.IPAddress }}' $DOCKER_NAME) --sensitive-url None --driver Firefox --html $CIRCLE_ARTIFACTS/results.html --junitxml $CIRCLE_TEST_REPORTS/junit.xml
