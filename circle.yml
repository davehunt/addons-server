machine:
  services:
    - docker
  environment:
    COMPOSE_PROJECT_NAME: 'addonsserver'
    DOCKER_NAME: 'addonsserver_web_1'

dependencies:
  override:
    - pip install -r requirements/uitest.txt

test:
  pre:
    - docker-compose pull
    - docker-compose up -d
  override:
    - mv conftest.py _conftest.py
    - cd src/olympia/amo/tests/ui
    - py.test -r a --base-url http://127.0.0.1 --driver Firefox --html $CIRCLE_ARTIFACTS/results.html --junitxml $CIRCLE_TEST_REPORTS/junit.xml
